package action.user;

import action.Action;
import dao.registerDAO;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class UserIdCheckAction_2ndbak implements Action {
    @Override
    public String execute(HttpServletRequest request, HttpServletResponse response) {
        String userId = request.getParameter("userId");

        System.out.println("input userId: " + userId);

        if (userId == null || userId.trim().isEmpty()) {
            System.out.println("Id is Empty or null.");
            request.setAttribute("isDuplicate", null);
            return "/jsp/user/register/checkUserId.jsp";
        }

        try {
            registerDAO dao = new registerDAO();
            int count = dao.UserIdCheck(userId);

            boolean isDuplicate = count > 0; // 1 이상이면 중복된 아이디
            System.out.println("isDuplicate: " + isDuplicate);

            request.setAttribute("isDuplicate", isDuplicate); // 결과 저장
        } catch (Exception e) {
            e.printStackTrace();
            try {
                response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "server error.");
                return null;
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        }

        return "/jsp/user/register/ajaxCheckUserId.jsp"; // JSP로 포워딩
    }
}


<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="movie">
    <!-- 사용자 메인 화면에서 예매율 상위 4개 영화 정보를 반환 -->
    <select id="getTopMovie" resultType="mybatis.vo.MovieVO">
        SELECT * FROM movie
        WHERE movieActive = 0
        ORDER BY movieReservationRate DESC
        LIMIT 4
    </select>

    <!-- 사용자 영화 메인 화면에서 전체 영화 리스트를 반환 -->
    <select id="getTotalMovie" resultType="mybatis.vo.MovieVO">
        SELECT * FROM movie
        WHERE movieActive = 0
        ORDER BY movieReservationRate DESC
    </select>

    <!-- 영화 idx를 받아서 사용자 영화 상세 화면으로 해당 영화 정보 반환 -->
    <select id="getMovieByIdx" parameterType="String" resultType="mybatis.vo.MovieVO">
        SELECT * FROM movie
        WHERE movieIdx = #{movieIdx}
    </select>

    <!-- 관리자 모드에서 OPEN API를 이용하여 영화 정보를 DB에 저장 -->
    <insert id="addNewMovie" parameterType="mybatis.vo.MovieVO">
        INSERT INTO movie(movieCd, movieTitle, movieTitleEn, movieGenre, movieTime, movieGrade, movieDate,
        movieDirector, movieActors, movieInfo, moviePosterUrl,
        movieReservationRate, movieTotalAudience, movieLikes, movieStatus, movieActive)
        VALUES (#{movieCd}, #{movieTitle}, #{movieTitleEn}, #{movieGenre}, #{movieTime}, #{movieGrade}, #{movieDate},
        #{movieDirector}, #{movieActors}, #{movieInfo}, #{moviePosterUrl},
        #{movieReservationRate}, #{movieTotalAudience}, #{movieLikes}, #{movieStatus}, #{movieActive})
    </insert>
</mapper>